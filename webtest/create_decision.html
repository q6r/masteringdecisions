
<html>

<body>

	<form>
		<input type="submit" id="testcreate" value="Create test person"></input>

	</form>

		
		<label for="pid">person_id</label>
		<input type="text" id="pid"></input>
		<br />

		<label for="name">name</label>
		<input type="text" id="name"></input>
		<br />

		<label for="desc">description</label>
		<input type="text" id="desc"></input>
		<br />

		<label for="oid">owner_id</label>
		<input type="text" id="oid"></input>
		<br />

		<label for="stg">stage</label>
		<input type="text" id="stg"></input>
		<br />

		<label for="cstyle">crit vote style</label>
		<input type="text" id= "cstyle"></input>	
		<br />

		<label for="astyle">alt vote style</label>
		<input type="text" id="astyle"></input>
		<br />

		<label for="settings">settings</label>
		<input type="text" id="settings"></input>
		<br />	



		<input type="submit" id="testdec" value="create decision"></input>

	<form>
		


	</form>

<script>


var base_url = "http://localhost:9999";

get_text = function(url, cb) {
	var request = new XMLHttpRequest();
	request.open('GET', base_url+url, true);
	request.setRequestHeader("Content-Type", "application/json");

	request.onreadystatechange = function() {
		if(request.readyState == 4 && request.status == 200) {
			cb(JSON.parse(request.responseText));
		}
	}

	request.send();
}

post_text = function(url, data, cb) {
	var request = new XMLHttpRequest();
	request.open('POST', base_url+url, true);
	request.setRequestHeader("Content-Type", "application/json");

	request.onreadystatechange = function() {
		if(request.readyState == 4 && request.status == 200) {
			cb(JSON.parse(request.responseText));
		}
	}

	request.send(data);
}

function assert(condition, message) {
    if (!condition) {
        throw message || "Assertion failed";
    }
}

function create_person(person, cb) {
	post_text("/person", JSON.stringify(person), cb)
}



document.getElementById("testcreate").onclick = function () {


	new_person = {
		"email": "jln3@pdx.edu",
		"pw_hash":"bloopr",
		"name_first":"Jasons",
		"name_last":"Nelsons"}

	create_person(new_person, function (person) {
	
		assert(person["email"] == "jln3@pdx.edu", "Wrong email");


	});
}

document.getElementById("testdec").onclick = function () {

//	new_login = {
//		"email":"jln3@pdx.edu",
//		"password":"bloopr"}
	
//	post_text("/login", JSON.stringify(new_login), function (result) {
//		console.log(result);
//	});


//	get_text("/whoami", function (result) {
//
//		console.log(result["error"]);
//
//	});

	new_decision = {
		"person_id":document.getElementById("pid").value,
		"name":document.getElementById("name").value,
		"description":document.getElementById("desc").value,
		"owner_id":document.getElementById("oid").value,
		"stage":document.getElementById("stg").value,
		"criterion_vote_style":document.getElementById("cstyle").value,
		"alternative_vote_style":document.getElementById("astyle").value,
		"client_settings":document.getElementById("settings").value

	}	


	post_text("/decision", JSON.stringify(new_decision), function(decision) {

		console.log(decision);

	});


}




</script>




</body>
</html>

